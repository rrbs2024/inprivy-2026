{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>INPRIVY - Conteúdos</title>
    <link rel="stylesheet" href="{% static 'css/conteudo.css' %}">    
</head>
<body>

<h2>Conteúdos dos Associados</h2>

<div class="timeline-container">

    {% for post in posts %}
    <div class="post-card">

        <div class="post-header">
            <div class="post-avatar">
                {% if post.associado.avatar %}
                    <img src="{{ post.associado.avatar.url }}" alt="{{ post.associado.associado_nome }}">
                {% else %}
                    <div style="width:48px; height:48px; border-radius:50%; background:#e6e67d;"></div>
                {% endif %}
            </div>
            <div>
                <div class="post-user">{{ post.associado.associado_nome }}</div>
                <div class="post-date">{{ post.criado_em|date:"d/m/Y H:i" }}</div>
            </div>
        </div>

        <div class="post-text">{{ post.texto }}</div>

        <div class="post-media">

            {% if post.imagem %}
                <img src="{{ post.imagem.url }}" alt="Imagem do post" style="max-width:50%; max-height:200px; border-radius:10px;">
            {% endif %}

            {% if post.video %}
                <video controls style="max-width:100%; border-radius:10px;">
                    <source src="{{ post.video.url }}" type="video/mp4">
                </video>
            {% endif %}
                 
        </div>

        <!-- ========================= -->
        <!-- COMENTÁRIOS -->
        <!-- ========================= -->
        <div class="post-comments">

            {% for comentario in post.comentarios.all %}
                <div class="comment">
                    <strong>{{ comentario.autor.associado_nome }}</strong>:
                    {{ comentario.texto }}
                    <div style="font-size:12px;color:#777;">
                        {{ comentario.criado_em|date:"d/m/Y H:i" }}
                    </div>
                </div>
            {% empty %}
                <div style="font-size:13px;color:#999;">
                    Nenhum comentário ainda.
                </div>
            {% endfor %}

        </div>

        <!-- ========================= -->
        <!-- FORM DE COMENTAR -->
        <!-- ========================= -->
        <form method="POST" action="{% url 'comentar_timeline' post.id %}">
            {% csrf_token %}
            <textarea name="texto"
                      rows="2"
                      placeholder="Escreva um comentário..."
                      style="width:100%;margin-top:10px;"></textarea>
            <button type="submit">Comentar</button>
        </form>

    </div>
    {% empty %}
        <div class="timeline-empty">Nenhuma publicação ainda.</div>
    {% endfor %}

    <button type="button" class="botao-retornar" onclick="history.back()">Retornar</button>

</div>
    
</body>
</html>
